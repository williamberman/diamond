docker run -it --gpus all --ipc=host -v /mnt/raid:/mnt/raid -v "$(pwd)":/workspace pytorch/pytorch:2.4.1-cuda12.4-cudnn9-runtime bash
apt-get update && apt-get install ffmpeg libsm6 libxext6 -y && pip install -r requirements.txt

python src/play.py --pretrained --record --recording-dir ./breakout_recordings --default-env test --game 7 --headless-collect-n 1000
python src/train_action_labeler.py --data_dir ./breakout_recordings/
python src/main.py env.train.id=BreakoutNoFrameskip-v4 common.device=cuda:0

python src/play.py --pretrained --record --recording-dir ./pong_recordings --default-env test --game 20 --headless-collect-n 400 --device cuda:1
python src/train_action_labeler.py --data_dir ./pong_recordings/ --device cuda:1
python src/main.py env.train.id=PongNoFrameskip-v4 common.device=cuda:1

./run.sh Breakout 0
docker exec -it brave_beaver bash -c "./run.sh Pong 1"
docker exec -it brave_beaver bash -c "./run.sh Alien 2"
docker exec -it brave_beaver bash -c "./run.sh Amidar 3"
docker exec -it brave_beaver bash -c "./run.sh Assault 4"
docker exec -it brave_beaver bash -c "./run.sh Asterix 5"
docker exec -it brave_beaver bash -c "./run.sh BankHeist 6"
docker exec -it brave_beaver bash -c "./run.sh BattleZone 7"

# To watch/play a pretrained agent
python src/play.py --path-ckpt /Users/williamberman/Downloads/agent_epoch_00001.pt --horizon 100 --game Pong
python src/play.py --path-ckpt /Users/williamberman/Downloads/agent_epoch_00004.pt --horizon 100 --game Breakout

# To collect reward data for a pretrained agent
```bash
python src/play.py \
 --path-ckpt /Users/williamberman/Downloads/agent_epoch_00001.pt \
 --game Pong \
 --headless-collect-n 100 \
 --default-env test \
 --write-rewards ./reward_data/pong_rewards.json
```
```bash
python src/play.py \
 --path-ckpt /Users/williamberman/Downloads/agent_epoch_00004.pt \
 --game Breakout \
 --headless-collect-n 100 \
 --default-env test \
 --write-rewards ./reward_data/breakout_rewards.json
```

```bash
python src/play.py \
 --path-ckpt /Users/williamberman/Downloads/agent_epoch_00004.pt \
 --game Breakout \
 --headless-collect-n 4 \
 --headless-collect-n-threads 2 \
 --default-env test \
 --write-rewards ./reward_data/breakout_rewards.json
```

```bash
python src/compute_atari_100k.py --dir-for-my-scores ./reward_data
```